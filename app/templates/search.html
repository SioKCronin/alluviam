{% extends "layout.html" %}

{% block title %}Alluvium{% endblock %}

{% block body %}

<h5>Search results for {{ query }}</h5>

<ul id="result-list" class="collection"></ul>
<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.1.1/socket.io.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.8.1/axios.min.js"></script>
<script>
var resultList = document.getElementById('result-list');
var socket = io('http://' + document.domain + ':' + location.port);

// join room
socket.on('connect', function() {
    socket.emit('join', { room: '{{ room }}' });
    console.log("Joined room");
});

// event handler for receiving a 'new_result' event on the socket.
socket.on('new_result', function(data) {
  resultList.innerHTML = '<li class="collection-item">'+data.new_val.query+'</li>' + resultList.innerHTML;
});

// log general messages
socket.on('message', function(data) {
    console.log("Got a message from the server:");
    console.log(data);
});

</script>

{% endblock %}
